{"level":"error","message":"The client is closed The client is closed","stack":"Error: The client is closed\n    at Commander._RedisClient_sendCommand (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/client/index.js:408:31)\n    at Commander.commandsExecutor (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/client/index.js:166:154)\n    at Commander.BaseClass.<computed> [as set] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/commander.js:8:29)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/index.js:16:15\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:112:3)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)"}
{"level":"error","message":"The client is closed The client is closed","stack":"Error: The client is closed\n    at Commander._RedisClient_sendCommand (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/client/index.js:408:31)\n    at Commander.commandsExecutor (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/client/index.js:166:154)\n    at Commander.BaseClass.<computed> [as set] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/commander.js:8:29)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/index.js:16:15\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:112:3)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)"}
{"level":"error","message":"Socket already opened Socket already opened","stack":"Error: Socket already opened\n    at RedisSocket.connect (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/client/socket.js:48:19)\n    at Commander.connect (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@node-redis/client/dist/lib/client/index.js:162:70)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/index.js:16:15\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:112:3)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/index.js:281:22"}
{"code":"ENOENT","errno":-2,"level":"error","message":"ENOENT: no such file or directory, open '/home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/assets/attendency.xlsx' ENOENT: no such file or directory, open '/home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/assets/attendency.xlsx'","path":"/home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/assets/attendency.xlsx","stack":"Error: ENOENT: no such file or directory, open '/home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/assets/attendency.xlsx'","syscall":"open"}
{"code":"ERR_STREAM_CANNOT_PIPE","level":"error","message":"Cannot pipe, not readable Cannot pipe, not readable","stack":"Error [ERR_STREAM_CANNOT_PIPE]: Cannot pipe, not readable\n    at new NodeError (node:internal/errors:371:5)\n    at WriteStream.Writable.pipe (node:internal/streams/writable:280:24)\n    at exports.downloadEmployeesPresence (/home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/admin.js:144:16)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:112:3)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/index.js:281:22"}
{"code":"ERR_STREAM_CANNOT_PIPE","level":"error","message":"Cannot pipe, not readable Cannot pipe, not readable","stack":"Error [ERR_STREAM_CANNOT_PIPE]: Cannot pipe, not readable\n    at new NodeError (node:internal/errors:371:5)\n    at WriteStream.Writable.pipe (node:internal/streams/writable:280:24)\n    at exports.downloadEmployeesPresence (/home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/admin.js:144:16)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at next (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:137:13)\n    at Route.dispatch (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/route.js:112:3)\n    at newFn (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express-async-errors/index.js:16:20)\n    at Layer.handle [as handle_request] (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/layer.js:95:5)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/express/lib/router/index.js:281:22"}
{"level":"error","message":"filename is not defined filename is not defined","stack":"ReferenceError: filename is not defined\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/Controllers/admin.js:152:35\n    at FSReqCallback.readFileAfterClose [as oncomplete] (node:internal/fs/read_file_context:68:3)"}
{"level":"error","message":"Cannot read properties of undefined (reading 'id') Cannot read properties of undefined (reading 'id')","stack":"TypeError: Cannot read properties of undefined (reading 'id')\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:14:55\n    at Object.exports.checkEmployee (/home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:10:3)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async exports.checkAdmin (/home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:13:3)"}
{"level":"error","message":"Cannot read properties of null (reading 'isAdmin') Cannot read properties of null (reading 'isAdmin')","stack":"TypeError: Cannot read properties of null (reading 'isAdmin')\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:18:19\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"Cannot read properties of undefined (reading '_id') Cannot read properties of undefined (reading '_id')","stack":"TypeError: Cannot read properties of undefined (reading '_id')\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:17:55\n    at Object.exports.checkEmployee (/home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:13:3)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\n    at async exports.checkAdmin (/home/mehdi/Documents/study/sem2/SEE/project/server/middleware/auth.js:16:3)"}
{"code":"ENOENT","errno":-2,"level":"error","message":"ENOENT: no such file or directory, open '/home/mehdi/Documents/study/sem2/SEE/project/server/utils/test.csv' ENOENT: no such file or directory, open '/home/mehdi/Documents/study/sem2/SEE/project/server/utils/test.csv'","path":"/home/mehdi/Documents/study/sem2/SEE/project/server/utils/test.csv","stack":"Error: ENOENT: no such file or directory, open '/home/mehdi/Documents/study/sem2/SEE/project/server/utils/test.csv'","syscall":"open"}
{"level":"error","message":"getPresence is not defined getPresence is not defined","stack":"ReferenceError: getPresence is not defined\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:68:3)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/index.js:20:3\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"Cannot read properties of undefined (reading 'getPresence') Cannot read properties of undefined (reading 'getPresence')","stack":"TypeError: Cannot read properties of undefined (reading 'getPresence')\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:68:26)\n    at /home/mehdi/Documents/study/sem2/SEE/project/server/index.js:20:3\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"addDays is not defined addDays is not defined","stack":"ReferenceError: addDays is not defined\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:75:15)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"stream.write(...).pipe is not a function stream.write(...).pipe is not a function","stack":"TypeError: stream.write(...).pipe is not a function\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:96:29)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"rows.reduce is not a function rows.reduce is not a function","stack":"TypeError: rows.reduce is not a function\n    at Object.exports.write (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@fast-csv/format/build/src/index.js:42:10)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:96:23)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"parse.write is not a function parse.write is not a function","stack":"TypeError: parse.write is not a function\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:96:9)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"code":"ERR_STREAM_CANNOT_PIPE","level":"error","message":"Cannot pipe, not readable Cannot pipe, not readable","stack":"Error [ERR_STREAM_CANNOT_PIPE]: Cannot pipe, not readable\n    at new NodeError (node:internal/errors:371:5)\n    at WriteStream.Writable.pipe (node:internal/streams/writable:280:24)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:96:10)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"Cannot access 'stream' before initialization Cannot access 'stream' before initialization","stack":"ReferenceError: Cannot access 'stream' before initialization\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:89:17)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"dest.on is not a function dest.on is not a function","stack":"TypeError: dest.on is not a function\n    at CsvFormatterStream.Readable.pipe (node:internal/streams/readable:680:8)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:95:29)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array","stack":"TypeError [ERR_INVALID_ARG_TYPE]: The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array\n    at new NodeError (node:internal/errors:371:5)\n    at _write (node:internal/streams/writable:312:13)\n    at WriteStream.Writable.write (node:internal/streams/writable:334:10)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:95:50)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array","stack":"TypeError [ERR_INVALID_ARG_TYPE]: The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array\n    at new NodeError (node:internal/errors:371:5)\n    at _write (node:internal/streams/writable:312:13)\n    at WriteStream.Writable.write (node:internal/streams/writable:334:10)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:95:50)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"code":"ERR_INVALID_ARG_TYPE","level":"error","message":"The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array","stack":"TypeError [ERR_INVALID_ARG_TYPE]: The \"chunk\" argument must be of type string or an instance of Buffer or Uint8Array. Received an instance of Array\n    at new NodeError (node:internal/errors:371:5)\n    at _write (node:internal/streams/writable:312:13)\n    at WriteStream.Writable.write (node:internal/streams/writable:334:10)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:96:50)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
{"level":"error","message":"rows.reduce is not a function rows.reduce is not a function","stack":"TypeError: rows.reduce is not a function\n    at exports.write (/home/mehdi/Documents/study/sem2/SEE/project/server/node_modules/@fast-csv/format/build/src/index.js:42:10)\n    at exports.insertUser (/home/mehdi/Documents/study/sem2/SEE/project/server/utils/data.js:94:3)\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)"}
